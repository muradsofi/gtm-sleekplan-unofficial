___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Sleekplan Tag (unofficial)",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Unofficial GTM tag template for integrating Sleekplan. Loads widget, sets user data, and adds metadata. Community supported, not officially endorsed.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "sleekPlanTagType",
    "displayName": {
      "text": "Tag Type",
      "translations": [
        {
          "locale": "de",
          "text": "Tag-Typ"
        },
        {
          "locale": "fr",
          "text": "Type de tag"
        },
        {
          "locale": "es",
          "text": "Tipo de etiqueta"
        },
        {
          "locale": "it",
          "text": "Tipo di tag"
        },
        {
          "locale": "nl",
          "text": "Tag type"
        },
        {
          "locale": "pt",
          "text": "Tipo de tag"
        },
        {
          "locale": "ja",
          "text": "タグタイプ"
        },
        {
          "locale": "zh",
          "text": "标签类型"
        }
      ]
    },
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "widget_load",
        "displayValue": {
          "text": "Widget Load",
          "translations": [
            {
              "locale": "de",
              "text": "Widget laden"
            },
            {
              "locale": "fr",
              "text": "Chargement du widget"
            },
            {
              "locale": "es",
              "text": "Cargar widget"
            },
            {
              "locale": "it",
              "text": "Caricamento widget"
            },
            {
              "locale": "nl",
              "text": "Widget laden"
            },
            {
              "locale": "pt",
              "text": "Carregar widget"
            },
            {
              "locale": "ja",
              "text": "ウィジェットの読み込み"
            },
            {
              "locale": "zh",
              "text": "加载小部件"
            }
          ]
        }
      },
      {
        "value": "set_user",
        "displayValue": {
          "text": "Set User",
          "translations": [
            {
              "locale": "de",
              "text": "Benutzer festlegen"
            },
            {
              "locale": "fr",
              "text": "Définir l'utilisateur"
            },
            {
              "locale": "es",
              "text": "Configurar usuario"
            },
            {
              "locale": "it",
              "text": "Imposta utente"
            },
            {
              "locale": "nl",
              "text": "Gebruiker instellen"
            },
            {
              "locale": "pt",
              "text": "Definir usuário"
            },
            {
              "locale": "ja",
              "text": "ユーザー設定"
            },
            {
              "locale": "zh",
              "text": "设置用户"
            }
          ]
        }
      },
      {
        "value": "add_metadata",
        "displayValue": {
          "text": "Add Metadata",
          "translations": [
            {
              "locale": "de",
              "text": "Metadaten hinzufügen"
            },
            {
              "locale": "fr",
              "text": "Ajouter des métadonnées"
            },
            {
              "locale": "es",
              "text": "Añadir metadatos"
            },
            {
              "locale": "it",
              "text": "Aggiungi metadati"
            },
            {
              "locale": "nl",
              "text": "Metadata toevoegen"
            },
            {
              "locale": "pt",
              "text": "Adicionar metadados"
            },
            {
              "locale": "ja",
              "text": "メタデータを追加"
            },
            {
              "locale": "zh",
              "text": "添加元数据"
            }
          ]
        }
      }
    ],
    "simpleValueType": true,
    "defaultValue": "widget_load",
    "help": {
      "text": "Select the operation to perform. 'Widget Load' loads the Sleekplan widget. 'Set User' updates user data. 'Add Metadata' adds additional metadata",
      "translations": [
        {
          "locale": "de",
          "text": "Wählen Sie die auszuführende Operation aus. 'Widget laden' lädt das Sleekplan-Widget. 'Benutzer setzen' aktualisiert Benutzerdaten. 'Metadaten hinzufügen' fügt zusätzliche Metadaten hinzu."
        },
        {
          "locale": "fr",
          "text": "Sélectionnez l'opération à effectuer. 'Chargement du widget' charge le widget Sleekplan. 'Définir l'utilisateur' met à jour les données utilisateur. 'Ajouter des métadonnées' ajoute des métadonnées supplémentaires."
        }
      ]
    }
  },
  {
    "type": "TEXT",
    "name": "sleekPlanApiKey",
    "displayName": {
      "text": "Sleekplan API Key",
      "translations": [
        {
          "locale": "de",
          "text": "Sleekplan API-Schlüssel"
        },
        {
          "locale": "fr",
          "text": "Clé API Sleekplan"
        },
        {
          "locale": "es",
          "text": "Clave API de Sleekplan"
        },
        {
          "locale": "it",
          "text": "Chiave API Sleekplan"
        },
        {
          "locale": "nl",
          "text": "Sleekplan API-sleutel"
        },
        {
          "locale": "pt",
          "text": "Chave API Sleekplan"
        },
        {
          "locale": "ja",
          "text": "Sleekplan APIキー"
        },
        {
          "locale": "zh",
          "text": "Sleekplan API密钥"
        }
      ]
    },
    "simpleValueType": true,
    "help": {
      "text": "Enter your Sleekplan API key to load the feedback widget.",
      "translations": [
        {
          "locale": "de",
          "text": "Geben Sie Ihren Sleekplan-API-Schlüssel ein, um das Feedback-Widget zu laden."
        },
        {
          "locale": "fr",
          "text": "Saisissez votre clé API Sleekplan pour charger le widget de commentaires."
        },
        {
          "locale": "es",
          "text": "Ingrese su clave API de Sleekplan para cargar el widget de comentarios."
        },
        {
          "locale": "it",
          "text": "Inserisci la tua chiave API Sleekplan per caricare il widget di feedback."
        },
        {
          "locale": "nl",
          "text": "Voer uw Sleekplan API-sleutel in om de feedback-widget te laden."
        },
        {
          "locale": "pt",
          "text": "Digite sua chave API Sleekplan para carregar o widget de feedback."
        },
        {
          "locale": "ja",
          "text": "フィードバックウィジェットを読み込むためにSleekplan APIキーを入力してください。"
        },
        {
          "locale": "zh",
          "text": "输入您的Sleekplan API密钥以加载反馈小部件。"
        }
      ]
    },
    "valueValidators": [
      {
        "type": "NON_EMPTY",
        "enablingConditions": [
          {
            "paramName": "sleekPlanTagType",
            "paramValue": "widget_load",
            "type": "EQUALS"
          }
        ]
      }
    ],
    "enablingConditions": [
      {
        "paramName": "sleekPlanTagType",
        "paramValue": "widget_load",
        "type": "EQUALS"
      }
    ],
    "valueHint": {
      "text": "Enter your Sleekplan API key",
      "translations": [
        {
          "locale": "de",
          "text": "Geben Sie Ihren Sleekplan-API-Schlüssel ein"
        },
        {
          "locale": "fr",
          "text": "Entrez votre clé API Sleekplan"
        },
        {
          "locale": "es",
          "text": "Ingrese su clave API de Sleekplan"
        },
        {
          "locale": "it",
          "text": "Inserisci la tua chiave API Sleekplan"
        },
        {
          "locale": "nl",
          "text": "Voer uw Sleekplan API-sleutel in"
        },
        {
          "locale": "pt",
          "text": "Digite sua chave API Sleekplan"
        },
        {
          "locale": "ja",
          "text": "Sleekplan APIキーを入力"
        },
        {
          "locale": "zh",
          "text": "输入Sleekplan API密钥"
        }
      ]
    }
  },
  {
    "type": "SIMPLE_TABLE",
    "name": "sleekPlanUserPropertiesTable",
    "displayName": {
      "text": "User Properties",
      "translations": [
        {
          "locale": "de",
          "text": "Benutzereigenschaften"
        },
        {
          "locale": "fr",
          "text": "Propriétés utilisateur"
        },
        {
          "locale": "es",
          "text": "Propiedades del usuario"
        },
        {
          "locale": "it",
          "text": "Proprietà utente"
        },
        {
          "locale": "nl",
          "text": "Gebruikerseigenschappen"
        },
        {
          "locale": "pt",
          "text": "Propriedades do usuário"
        },
        {
          "locale": "ja",
          "text": "ユーザープロパティ"
        },
        {
          "locale": "zh",
          "text": "用户属性"
        }
      ]
    },
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": {
          "text": "Property Name",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftsname"
            },
            {
              "locale": "fr",
              "text": "Nom de la propriété"
            },
            {
              "locale": "es",
              "text": "Nombre de la propiedad"
            },
            {
              "locale": "it",
              "text": "Nome proprietà"
            },
            {
              "locale": "nl",
              "text": "Eigenschapnaam"
            },
            {
              "locale": "pt",
              "text": "Nome da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ名"
            },
            {
              "locale": "zh",
              "text": "属性名称"
            }
          ]
        },
        "name": "propertyName",
        "type": "TEXT",
        "valueHint": {
          "text": "Enter property name",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftsnamen eingeben"
            },
            {
              "locale": "fr",
              "text": "Entrez le nom de la propriété"
            },
            {
              "locale": "es",
              "text": "Ingrese el nombre de la propiedad"
            },
            {
              "locale": "it",
              "text": "Inserisci il nome della proprietà"
            },
            {
              "locale": "nl",
              "text": "Voer eigenschapnaam in"
            },
            {
              "locale": "pt",
              "text": "Digite o nome da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ名を入力"
            },
            {
              "locale": "zh",
              "text": "输入属性名称"
            }
          ]
        }
      },
      {
        "defaultValue": "",
        "displayName": {
          "text": "Property Value",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftswert"
            },
            {
              "locale": "fr",
              "text": "Valeur de la propriété"
            },
            {
              "locale": "es",
              "text": "Valor de la propiedad"
            },
            {
              "locale": "it",
              "text": "Valore proprietà"
            },
            {
              "locale": "nl",
              "text": "Eigenschapwaarde"
            },
            {
              "locale": "pt",
              "text": "Valor da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ値"
            },
            {
              "locale": "zh",
              "text": "属性值"
            }
          ]
        },
        "name": "propertyValue",
        "type": "TEXT",
        "valueHint": {
          "text": "Enter property value",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftswert eingeben"
            },
            {
              "locale": "fr",
              "text": "Entrez la valeur de la propriété"
            },
            {
              "locale": "es",
              "text": "Ingrese el valor de la propiedad"
            },
            {
              "locale": "it",
              "text": "Inserisci il valore della proprietà"
            },
            {
              "locale": "nl",
              "text": "Voer eigenschapwaarde in"
            },
            {
              "locale": "pt",
              "text": "Digite o valor da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ値を入力"
            },
            {
              "locale": "zh",
              "text": "输入属性值"
            }
          ]
        }
      }
    ],
    "enablingConditions": [
      {
        "paramName": "sleekPlanTagType",
        "paramValue": "set_user",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "SIMPLE_TABLE",
    "name": "sleekPlanMetaDataPropertiesTable",
    "displayName": {
      "text": "Meta Data Properties",
      "translations": [
        {
          "locale": "de",
          "text": "Metadaten-Eigenschaften"
        },
        {
          "locale": "fr",
          "text": "Propriétés des métadonnées"
        },
        {
          "locale": "es",
          "text": "Propiedades de metadatos"
        },
        {
          "locale": "it",
          "text": "Proprietà metadati"
        },
        {
          "locale": "nl",
          "text": "Metadata-eigenschappen"
        },
        {
          "locale": "pt",
          "text": "Propriedades de metadados"
        },
        {
          "locale": "ja",
          "text": "メタデータプロパティ"
        },
        {
          "locale": "zh",
          "text": "元数据属性"
        }
      ]
    },
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": {
          "text": "Property Name",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftsname"
            },
            {
              "locale": "fr",
              "text": "Nom de la propriété"
            },
            {
              "locale": "es",
              "text": "Nombre de la propiedad"
            },
            {
              "locale": "it",
              "text": "Nome proprietà"
            },
            {
              "locale": "nl",
              "text": "Eigenschapnaam"
            },
            {
              "locale": "pt",
              "text": "Nome da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ名"
            },
            {
              "locale": "zh",
              "text": "属性名称"
            }
          ]
        },
        "name": "propertyName",
        "type": "TEXT",
        "valueHint": {
          "text": "Enter property name",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftsnamen eingeben"
            },
            {
              "locale": "fr",
              "text": "Entrez le nom de la propriété"
            },
            {
              "locale": "es",
              "text": "Ingrese el nombre de la propiedad"
            },
            {
              "locale": "it",
              "text": "Inserisci il nome della proprietà"
            },
            {
              "locale": "nl",
              "text": "Voer eigenschapnaam in"
            },
            {
              "locale": "pt",
              "text": "Digite o nome da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ名を入力"
            },
            {
              "locale": "zh",
              "text": "输入属性名称"
            }
          ]
        }
      },
      {
        "defaultValue": "",
        "displayName": {
          "text": "Property Value",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftswert"
            },
            {
              "locale": "fr",
              "text": "Valeur de la propriété"
            },
            {
              "locale": "es",
              "text": "Valor de la propiedad"
            },
            {
              "locale": "it",
              "text": "Valore proprietà"
            },
            {
              "locale": "nl",
              "text": "Eigenschapwaarde"
            },
            {
              "locale": "pt",
              "text": "Valor da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ値"
            },
            {
              "locale": "zh",
              "text": "属性值"
            }
          ]
        },
        "name": "propertyValue",
        "type": "TEXT",
        "valueHint": {
          "text": "Enter property value",
          "translations": [
            {
              "locale": "de",
              "text": "Eigenschaftswert eingeben"
            },
            {
              "locale": "fr",
              "text": "Entrez la valeur de la propriété"
            },
            {
              "locale": "es",
              "text": "Ingrese el valor de la propiedad"
            },
            {
              "locale": "it",
              "text": "Inserisci il valore della proprietà"
            },
            {
              "locale": "nl",
              "text": "Voer eigenschapwaarde in"
            },
            {
              "locale": "pt",
              "text": "Digite o valor da propriedade"
            },
            {
              "locale": "ja",
              "text": "プロパティ値を入力"
            },
            {
              "locale": "zh",
              "text": "输入属性值"
            }
          ]
        }
      }
    ],
    "enablingConditions": [
      {
        "paramName": "sleekPlanTagType",
        "paramValue": "add_metadata",
        "type": "EQUALS"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const setInWindow = require('setInWindow');
const injectScript = require('injectScript');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const makeTableMap = require('makeTableMap');
const JSON = require('JSON'); // Use sandbox JSON API

// Ensure that sleekPlanTagType is provided.
if (!data.sleekPlanTagType) {
  data.gtmOnFailure('sleekPlanTagType is required.');
  return;
}

if (data.sleekPlanTagType === "widget_load") {
  // For widget_load, require the API key.
  if (!data.sleekPlanApiKey) {
    data.gtmOnFailure('Sleekplan API key is required for widget_load.');
    return;
  }
  
  // Set the global variable $sleek to an empty array.
  if (!setInWindow('$sleek', [], true)) {
    data.gtmOnFailure('Failed to set global variable $sleek.');
    return;
  }
  
  // Set the global variable SLEEK_PRODUCT_ID to the provided API key.
  if (!setInWindow('SLEEK_PRODUCT_ID', data.sleekPlanApiKey, true)) {
    data.gtmOnFailure('Failed to set global variable SLEEK_PRODUCT_ID.');
    return;
  }
  
  // (Optional) Verify that SLEEK_PRODUCT_ID was set correctly.
  const globalApiKey = copyFromWindow('SLEEK_PRODUCT_ID');
  if (globalApiKey !== data.sleekPlanApiKey) {
    data.gtmOnFailure('Global variable SLEEK_PRODUCT_ID was not set correctly.');
    return;
  }
  
  // Load the external Sleekplan script.
  const sleekplanUrl = 'https://client.sleekplan.com/sdk/e.js';
  injectScript(sleekplanUrl, data.gtmOnSuccess, data.gtmOnFailure, sleekplanUrl);
  
} else if (data.sleekPlanTagType === "set_user") {
  // For set_user, check if the user properties table is defined and non-empty.
  if (!data.sleekPlanUserPropertiesTable || data.sleekPlanUserPropertiesTable.length === 0) {
    // Nothing to update; simply succeed.
    data.gtmOnSuccess();
    return;
  }
  
  // Convert the SIMPLE_TABLE into an object for user properties.
  const userProps = makeTableMap(
    data.sleekPlanUserPropertiesTable,
    'propertyName',
    'propertyValue'
  );
  
  if (!userProps) {
    data.gtmOnSuccess();
    return;
  }
  
  // Call the global function $sleek.setUser with the userProps using callInWindow.
  callInWindow('$sleek.setUser', userProps);
  data.gtmOnSuccess();
  
} else if (data.sleekPlanTagType === "add_metadata") {
  // For add_metadata, check if the metadata table is defined and non-empty.
  if (!data.sleekPlanMetaDataPropertiesTable || data.sleekPlanMetaDataPropertiesTable.length === 0) {
    // Nothing to update; simply succeed.
    data.gtmOnSuccess();
    return;
  }
  
  // Convert the SIMPLE_TABLE into an object for metadata.
  const metaProps = makeTableMap(
    data.sleekPlanMetaDataPropertiesTable,
    'propertyName',
    'propertyValue'
  );
  
  if (!metaProps) {
    data.gtmOnSuccess();
    return;
  }
  
  // Call the global function $sleek.addMetadata with the metaProps using callInWindow.
  callInWindow('$sleek.addMetadata', metaProps);
  data.gtmOnSuccess();
  
} else {
  data.gtmOnFailure('Invalid sleekPlanTagType provided.');
  return;
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "$sleek"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "SLEEK_PRODUCT_ID"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "$sleek.addMetadata"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "$sleek.setUser"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://client.sleekplan.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 3/3/2025, 7:54:31 PM


